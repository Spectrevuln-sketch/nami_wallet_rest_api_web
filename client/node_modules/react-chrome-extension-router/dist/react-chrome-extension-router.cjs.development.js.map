{"version":3,"file":"react-chrome-extension-router.cjs.development.js","sources":["../src/utils.ts","../src/index.ts"],"sourcesContent":["import { useCallback, useState } from 'react';\n\nfunction useForceUpdate(): () => void {\n  const [, dispatch] = useState(Object.create(null));\n\n  return useCallback(() => {\n    dispatch(Object.create(null));\n  }, [dispatch]);\n}\n\nexport { useForceUpdate };\n","import * as React from 'react';\nimport { useForceUpdate } from './utils';\n\ntype RouterStackItem = {\n  component: React.ComponentType<any>;\n  props: any;\n};\n\nlet stack: RouterStackItem[] = [];\n\nlet forceUpdateStack: (() => void)[] = [];\n\nfunction useForceUpdateStack(): void {\n  const update = useForceUpdate();\n\n  React.useEffect(() => {\n    forceUpdateStack.push(update);\n\n    return () => {\n      const index = forceUpdateStack.indexOf(update);\n      if (index > -1) {\n        forceUpdateStack.splice(index, 1);\n      }\n    };\n  }, [update]);\n}\n\nfunction forceUpdate() {\n  forceUpdateStack.forEach(fn => fn());\n}\n\nfunction goTo(comp: React.ComponentType<any>, props: any = {}): void {\n  stack.push({ component: comp, props });\n  forceUpdate();\n}\n\nfunction goBack(): void {\n  if (stack.length) {\n    stack.pop();\n  }\n  forceUpdate();\n}\n\nfunction popToTop(): void {\n  stack = [];\n  forceUpdate();\n}\n\nfunction getCurrent(): RouterStackItem {\n  return stack[stack.length - 1] || { component: false, props: null };\n}\n\nfunction getComponentStack(): RouterStackItem[] {\n  return stack;\n}\n\ninterface LinkProps {\n  id?: string;\n  component: React.ComponentType<any>;\n  children?: React.ReactNode;\n  props?: any;\n  href?: string;\n  className?: string;\n  tag?: React.ComponentType<any> | keyof JSX.IntrinsicElements;\n  onClick?: (event: React.MouseEvent<HTMLAnchorElement>) => void;\n}\n\nfunction Link({\n  id = '',\n  component,\n  children,\n  props = {},\n  href = '',\n  className = '',\n  tag = 'a',\n  onClick,\n  ...restProps\n}: LinkProps & React.HTMLProps<HTMLElement>) {\n  const onClickHandler = React.useCallback(\n    (evt: React.MouseEvent<HTMLAnchorElement>) => {\n      evt.preventDefault();\n      if (component) {\n        goTo(component, props);\n      }\n      if (!component && href) {\n        window.open(href);\n      }\n      onClick && onClick(evt);\n    },\n    [component, props, href, onClick]\n  );\n\n  return React.createElement(\n    tag,\n    {\n      href,\n      className,\n      id,\n      onClick: onClickHandler,\n      ...restProps,\n    },\n    children\n  );\n}\n\ninterface NavLinkProps {\n  id?: string;\n  component: React.ComponentType<any>;\n  children?: React.ReactNode;\n  props?: any;\n  href?: string;\n  className?: string;\n  activeClassName?: string;\n  tag?: React.ComponentType<any> | keyof JSX.IntrinsicElements;\n  onClick?: (event: React.MouseEvent<HTMLAnchorElement>) => void;\n}\n\nfunction NavLink({\n  id = '',\n  component,\n  children,\n  props = {},\n  href = '',\n  className = '',\n  activeClassName = '',\n  tag = 'a',\n  onClick,\n  ...restProps\n}: NavLinkProps & React.HTMLProps<HTMLElement>) {\n  const onClickHandler = React.useCallback(\n    (evt: React.MouseEvent<HTMLAnchorElement>) => {\n      evt.preventDefault();\n      if (component) {\n        goTo(component, props);\n      }\n      if (!component && href) {\n        window.open(href);\n      }\n      onClick && onClick(evt);\n    },\n    [component, props, href, onClick]\n  );\n\n  useForceUpdateStack();\n\n  if (stack.length > 0 && stack[stack.length - 1].component === component) {\n    className = activeClassName + ' ' + className;\n  }\n\n  return React.createElement(\n    tag,\n    {\n      href,\n      className,\n      id,\n      onClick: onClickHandler,\n      ...restProps,\n    },\n    children\n  );\n}\n\ninterface RouterProps {\n  children: React.ReactNode;\n}\n\nconst emptyStackComponent: RouterStackItem = {\n  component: ({ children }: any) => children,\n  props: {},\n};\n\nfunction Router({ children }: RouterProps) {\n  useForceUpdateStack();\n\n  const { component: Component, props } =\n    stack[stack.length - 1] || emptyStackComponent;\n\n  return React.createElement(Component, props, children);\n}\n\nexport {\n  goBack,\n  getCurrent,\n  getComponentStack,\n  goTo,\n  popToTop,\n  LinkProps,\n  RouterProps,\n  Link,\n  NavLink,\n  Router,\n};\n"],"names":["useForceUpdate","useState","Object","create","dispatch","useCallback","stack","forceUpdateStack","useForceUpdateStack","update","React","push","index","indexOf","splice","forceUpdate","forEach","fn","goTo","comp","props","component","goBack","length","pop","popToTop","getCurrent","getComponentStack","Link","id","children","href","className","tag","onClick","restProps","onClickHandler","evt","preventDefault","window","open","NavLink","activeClassName","emptyStackComponent","Router","Component"],"mappings":"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"}