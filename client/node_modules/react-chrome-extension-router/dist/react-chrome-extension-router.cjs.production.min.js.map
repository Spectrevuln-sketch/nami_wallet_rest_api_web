{"version":3,"file":"react-chrome-extension-router.cjs.production.min.js","sources":["../src/index.ts","../src/utils.ts"],"sourcesContent":["import * as React from 'react';\nimport { useForceUpdate } from './utils';\n\ntype RouterStackItem = {\n  component: React.ComponentType<any>;\n  props: any;\n};\n\nlet stack: RouterStackItem[] = [];\n\nlet forceUpdateStack: (() => void)[] = [];\n\nfunction useForceUpdateStack(): void {\n  const update = useForceUpdate();\n\n  React.useEffect(() => {\n    forceUpdateStack.push(update);\n\n    return () => {\n      const index = forceUpdateStack.indexOf(update);\n      if (index > -1) {\n        forceUpdateStack.splice(index, 1);\n      }\n    };\n  }, [update]);\n}\n\nfunction forceUpdate() {\n  forceUpdateStack.forEach(fn => fn());\n}\n\nfunction goTo(comp: React.ComponentType<any>, props: any = {}): void {\n  stack.push({ component: comp, props });\n  forceUpdate();\n}\n\nfunction goBack(): void {\n  if (stack.length) {\n    stack.pop();\n  }\n  forceUpdate();\n}\n\nfunction popToTop(): void {\n  stack = [];\n  forceUpdate();\n}\n\nfunction getCurrent(): RouterStackItem {\n  return stack[stack.length - 1] || { component: false, props: null };\n}\n\nfunction getComponentStack(): RouterStackItem[] {\n  return stack;\n}\n\ninterface LinkProps {\n  id?: string;\n  component: React.ComponentType<any>;\n  children?: React.ReactNode;\n  props?: any;\n  href?: string;\n  className?: string;\n  tag?: React.ComponentType<any> | keyof JSX.IntrinsicElements;\n  onClick?: (event: React.MouseEvent<HTMLAnchorElement>) => void;\n}\n\nfunction Link({\n  id = '',\n  component,\n  children,\n  props = {},\n  href = '',\n  className = '',\n  tag = 'a',\n  onClick,\n  ...restProps\n}: LinkProps & React.HTMLProps<HTMLElement>) {\n  const onClickHandler = React.useCallback(\n    (evt: React.MouseEvent<HTMLAnchorElement>) => {\n      evt.preventDefault();\n      if (component) {\n        goTo(component, props);\n      }\n      if (!component && href) {\n        window.open(href);\n      }\n      onClick && onClick(evt);\n    },\n    [component, props, href, onClick]\n  );\n\n  return React.createElement(\n    tag,\n    {\n      href,\n      className,\n      id,\n      onClick: onClickHandler,\n      ...restProps,\n    },\n    children\n  );\n}\n\ninterface NavLinkProps {\n  id?: string;\n  component: React.ComponentType<any>;\n  children?: React.ReactNode;\n  props?: any;\n  href?: string;\n  className?: string;\n  activeClassName?: string;\n  tag?: React.ComponentType<any> | keyof JSX.IntrinsicElements;\n  onClick?: (event: React.MouseEvent<HTMLAnchorElement>) => void;\n}\n\nfunction NavLink({\n  id = '',\n  component,\n  children,\n  props = {},\n  href = '',\n  className = '',\n  activeClassName = '',\n  tag = 'a',\n  onClick,\n  ...restProps\n}: NavLinkProps & React.HTMLProps<HTMLElement>) {\n  const onClickHandler = React.useCallback(\n    (evt: React.MouseEvent<HTMLAnchorElement>) => {\n      evt.preventDefault();\n      if (component) {\n        goTo(component, props);\n      }\n      if (!component && href) {\n        window.open(href);\n      }\n      onClick && onClick(evt);\n    },\n    [component, props, href, onClick]\n  );\n\n  useForceUpdateStack();\n\n  if (stack.length > 0 && stack[stack.length - 1].component === component) {\n    className = activeClassName + ' ' + className;\n  }\n\n  return React.createElement(\n    tag,\n    {\n      href,\n      className,\n      id,\n      onClick: onClickHandler,\n      ...restProps,\n    },\n    children\n  );\n}\n\ninterface RouterProps {\n  children: React.ReactNode;\n}\n\nconst emptyStackComponent: RouterStackItem = {\n  component: ({ children }: any) => children,\n  props: {},\n};\n\nfunction Router({ children }: RouterProps) {\n  useForceUpdateStack();\n\n  const { component: Component, props } =\n    stack[stack.length - 1] || emptyStackComponent;\n\n  return React.createElement(Component, props, children);\n}\n\nexport {\n  goBack,\n  getCurrent,\n  getComponentStack,\n  goTo,\n  popToTop,\n  LinkProps,\n  RouterProps,\n  Link,\n  NavLink,\n  Router,\n};\n","import { useCallback, useState } from 'react';\n\nfunction useForceUpdate(): () => void {\n  const [, dispatch] = useState(Object.create(null));\n\n  return useCallback(() => {\n    dispatch(Object.create(null));\n  }, [dispatch]);\n}\n\nexport { useForceUpdate };\n"],"names":["stack","forceUpdateStack","useForceUpdateStack","dispatch","update","useState","Object","create","useCallback","React","push","index","indexOf","splice","forceUpdate","forEach","fn","goTo","comp","props","component","emptyStackComponent","children","id","href","className","tag","onClick","restProps","onClickHandler","evt","preventDefault","window","open","activeClassName","length","pop"],"mappings":"8aAQA,IAAIA,EAA2B,GAE3BC,EAAmC,GAEvC,SAASC,QCTEC,EDUHC,GCVGD,EAAYE,WAASC,OAAOC,OAAO,UAErCC,eAAY,WACjBL,EAASG,OAAOC,OAAO,SACtB,CAACJ,KDQJM,aAAgB,kBACdR,EAAiBS,KAAKN,GAEf,eACCO,EAAQV,EAAiBW,QAAQR,GACnCO,GAAS,GACXV,EAAiBY,OAAOF,EAAO,MAGlC,CAACP,IAGN,SAASU,IACPb,EAAiBc,SAAQ,SAAAC,UAAMA,OAGjC,SAASC,EAAKC,EAAgCC,YAAAA,IAAAA,EAAa,IACzDnB,EAAMU,KAAK,CAAEU,UAAWF,EAAMC,MAAAA,IAC9BL,IAqIF,IAAMO,EAAuC,CAC3CD,UAAW,qBAAGE,UACdH,MAAO,iBArGT,oBACEI,GAAAA,aAAK,KACLH,IAAAA,UACAE,IAAAA,aACAH,MAAAA,aAAQ,SACRK,KAAAA,aAAO,SACPC,UAAAA,aAAY,SACZC,IAAAA,aAAM,MACNC,IAAAA,QACGC,gFAEGC,EAAiBpB,eACrB,SAACqB,GACCA,EAAIC,iBACAX,GACFH,EAAKG,EAAWD,IAEbC,GAAaI,GAChBQ,OAAOC,KAAKT,GAEdG,GAAWA,EAAQG,KAErB,CAACV,EAAWD,EAAOK,EAAMG,WAGpBlB,gBACLiB,KAEEF,KAAAA,EACAC,UAAAA,EACAF,GAAAA,EACAI,QAASE,GACND,GAELN,oBAgBJ,oBACEC,GAAAA,aAAK,KACLH,IAAAA,UACAE,IAAAA,aACAH,MAAAA,aAAQ,SACRK,KAAAA,aAAO,SACPC,UAAAA,aAAY,SACZS,gBAAAA,aAAkB,SAClBR,IAAAA,aAAM,MACNC,IAAAA,QACGC,kGAEGC,EAAiBpB,eACrB,SAACqB,GACCA,EAAIC,iBACAX,GACFH,EAAKG,EAAWD,IAEbC,GAAaI,GAChBQ,OAAOC,KAAKT,GAEdG,GAAWA,EAAQG,KAErB,CAACV,EAAWD,EAAOK,EAAMG,WAG3BzB,IAEIF,EAAMmC,OAAS,GAAKnC,EAAMA,EAAMmC,OAAS,GAAGf,YAAcA,IAC5DK,EAAYS,EAAkB,IAAMT,GAG/BhB,gBACLiB,KAEEF,KAAAA,EACAC,UAAAA,EACAF,GAAAA,EACAI,QAASE,GACND,GAELN,mBAaJ,gBAAkBA,IAAAA,SAChBpB,UAGEF,EAAMA,EAAMmC,OAAS,IAAMd,SAEtBZ,kBAHCW,YAAsBD,MAGeG,8BA7H/C,kBACStB,sBALT,kBACSA,EAAMA,EAAMmC,OAAS,IAAM,CAAEf,WAAW,EAAOD,MAAO,sBAb/D,WACMnB,EAAMmC,QACRnC,EAAMoC,MAERtB,qCAGF,WACEd,EAAQ,GACRc"}